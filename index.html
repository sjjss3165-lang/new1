<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»æ©Ÿç§‘æ™ºæ…§é»é¤ç³»çµ± Pro</title>
    <style>
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: #f1f5f9; color: #334155; margin: 0; padding: 15px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h1 { text-align: center; color: #1e3a8a; font-size: 1.5rem; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px; }
        
        /* åº—å®¶åˆ‡æ›å€ */
        .store-selector { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; margin-bottom: 20px; }
        .store-btn { padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; background: white; cursor: pointer; font-size: 0.9rem; font-weight: bold; transition: 0.2s; }
        .store-btn.active { background: #2563eb; color: white; border-color: #2563eb; box-shadow: 0 0 10px rgba(37,99,235,0.3); }

        /* è¦æ ¼é¸å–® (æ–¹å¡Šæ ¼å¼) */
        .spec-label { font-size: 0.8rem; color: #64748b; margin: 10px 0 5px 0; }
        .spec-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-bottom: 10px; }
        .spec-item { border: 1px solid #2563eb; color: #2563eb; background: white; padding: 6px; border-radius: 4px; cursor: pointer; font-size: 12px; text-align: center; white-space: nowrap; }
        .spec-item.selected { background: #2563eb; color: white; }

        /* è¨‚å–®å…§å®¹ */
        .person-card { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; margin-bottom: 15px; border-left: 5px solid #2563eb; }
        .person-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .drink-select { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #cbd5e1; font-size: 1rem; margin-bottom: 5px; }
        
        .footer-total { position: sticky; bottom: 0; background: #1e293b; color: white; padding: 20px; border-radius: 10px 10px 0 0; display: flex; justify-content: space-between; align-items: center; margin-top: 30px; }
        .btn-copy { width: 100%; padding: 15px; background: #3b82f6; color: white; border: none; font-size: 1.1rem; font-weight: bold; cursor: pointer; border-radius: 0 0 10px 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>é›»æ©Ÿç§‘æ™ºæ…§é»é¤ç³»çµ± ğŸ‘©ğŸ¼â€ğŸ³</h1>
    
    <div class="store-selector" id="storeSelector"></div>

    <div style="background: #eff6ff; padding: 12px; border-radius: 8px; margin-bottom: 20px; border: 1px dashed #2563eb;">
        <strong>ğŸ“ ç›®å‰åº—å®¶ï¼š</strong><span id="activeStoreName" style="color:#2563eb; font-weight:bold;">è«‹é¸æ“‡åº—å®¶</span>
        <a id="extMenu" href="#" target="_blank" style="float:right; font-size:0.8rem; color:#64748b;">[é–‹å•Ÿå®˜æ–¹èœå–®é€£çµ]</a>
    </div>

    <div id="orderContainer"></div>
    
    <button onclick="addPerson()" style="width:100%; padding:12px; background:#10b981; color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer; margin-top:10px;">â• æ–°å¢è¨‚é¤åŒå­¸</button>
</div>

<div class="footer-total">
    <div>ç¸½æ•¸é‡ï¼š<span id="totalCount">0</span> æ¯</div>
    <div style="font-size:1.5rem; font-weight:bold;">ç¸½é‡‘é¡ï¼š$<span id="totalPrice">0</span></div>
</div>
<button class="btn-copy" onclick="copyResult()">ğŸ“‹ è¤‡è£½ LINE çµ±è¨ˆæ ¼å¼</button>

<script>
// --- 22 å®¶åº—å…¨å“é …è³‡æ–™åº« (ç°¡åŒ–ç¯„ä¾‹ï¼Œå¯¦éš›æœƒåŒ…å«æ‰€æœ‰å“é …) ---
const stores = {
    "å¾—æ­£": { link: "https://order.nidin.shop/menu/18739", menu: {"æ˜¥èŒ¶": 35, "ç„™çƒé¾": 35, "æª¸æª¬æ˜¥èŒ¶": 50, "èŠå£«å¥¶è“‹æ˜¥èŒ¶": 65, "çç å¥¶èŒ¶": 55, "ç„™çƒé¾å¥¶èŒ¶": 50}, toppings: {"ä¸åŠ æ–™":0, "èŒ¶å‡":10, "çç ":10} },
    "50åµ": { link: "https://order.nidin.shop/menu/21216", menu: {"å››å­£æ˜¥": 30, "çå¥¶": 50, "æ³¢éœ¸å¥¶èŒ¶": 50, "ç´…èŒ¶æ‹¿éµ": 60, "å…«å†°èŒ¶": 50, "å†°æ·‡æ·‹ç´…èŒ¶": 50}, toppings: {"ä¸åŠ æ–™":0, "æ³¢éœ¸":0, "çç ":0, "å¸ƒä¸":20} },
    "æ‹¾æ±£èŒ¶å±‹": { link: "https://www.19teahouse.com/", menu: {"æ„›ç‰å…¬çˆµ": 45, "çç é®®å¥¶èŒ¶": 60, "ç´”èŒ¶": 30, "ç²‰ç²¿æ¡‚èŠ±": 45}, toppings: {"ä¸åŠ æ–™":0, "ç²‰ç²¿":10, "çç ":10} },
    "å¯ä¸å¯": { link: "https://kebuke.com/menu/", menu: {"ç†Ÿæˆç´…èŒ¶": 35, "ç†Ÿæˆå¥¶èŒ¶": 50, "èƒ­è„‚ç´…èŒ¶": 40}, toppings: {"ä¸åŠ æ–™":0, "ç™½ç‰": 10} },
    "è¿·å®¢å¤": { link: "https://milksha.nidin.shop/menu/491", menu: {"çç é®®å¥¶": 70, "ç„™èŒ¶æ‹¿éµ": 65, "é’èŒ¶": 30}, toppings: {"ä¸åŠ æ–™": 0, "çç ": 10} },
    "é¾œè¨˜": { link: "https://guiji.doteat.tw/menu", menu: {"ç´…æŸšç¿¡ç¿ ": 75, "è˜‹æœç´…è±": 55}, toppings: {"ä¸åŠ æ–™": 0, "çç ": 10} },
    "æ¸…å¿ƒ": { link: "http://chingshin.tw/", menu: {"çƒé¾ç¶ ": 30, "å„ªå¤šç¶ ": 45, "éš±è—ç‰ˆ": 50}, toppings: {"ä¸åŠ æ–™": 0, "çç ": 10} },
    "è’Ÿè’»å±‹": { link: "https://drive.google.com/file/d/1T08WgpxufhYVOJ8sbfc7gvpthvoDaacY/view", menu: {"ç¶ è±†æ¹¯": 55, "ç¶œåˆè’Ÿè’»": 70, "è±†èŠ±": 45}, toppings: {"åŸå‘³":0, "åŠ çç ": 5, "åŠ ç´…è±†": 10} },
    "å»–åª½åª½": { link: "https://drive.google.com/file/d/1j_SjavYZbnJjJHCJNSzVQaAzf_1e5Km0/view", menu: {"æ’éª¨é£¯": 90, "é›è…¿é£¯": 100, "æ»·è‚‰é£¯": 35}, toppings: {"æ­£å¸¸": 0, "åŠ æ»·è›‹": 15} },
    "å¤§ç¢—ç‰›è‚‰éºµ": { link: "https://drive.google.com/file/d/12wii4UGfDTHYECO5ObXyS6qutY9qRcaX/view", menu: {"ç‰›è‚‰éºµ": 150, "ä¹¾éºµ": 70}, toppings: {"æ­£å¸¸":0, "åŠ å¤§":20} },
    "é‚±è¨˜ç‚’éºµ": { link: "https://drive.google.com/file/d/1zuEI_w-zwS9rIGRcekHsb_QXll1twyg3/view", menu: {"ç‚’éºµ": 80, "è²¢ä¸¸æ¹¯": 30}, toppings: {"ä¸åŠ æ–™":0} },
    "éº¥å…‹éºµç·š": { link: "http://google.com/maps", menu: {"å¤§è…¸éºµç·š": 55, "é­šé…¥éºµç·š": 55}, toppings: {"åŠ å¤§":10, "ä¸åŠ æ–™":0} },
    "è±†ä¹¾åŒ…": { link: "https://drive.google.com/file/d/18VeBd_w6HFvBD321t7Iu-QaNfko5CljQ/view", menu: {"è±†ä¹¾åŒ…": 50}, toppings: {"ä¸åŠ æ–™":0} },
    "ç¾é¦™é½‹": { link: "https://drive.google.com/file/d/1pjCLx6xivI5e_Ud1zmMglOFFZtsjDFij/view", menu: {"æ»·å‘³æ‹¼ç›¤": 100}, toppings: {"ä¸åŠ æ–™":0} },
    "æ—é¦™æª¸": { link: "https://www.lamheunglingoverseas.com/cz", menu: {"æ‹›ç‰Œæª¸æª¬èŒ¶": 55}, toppings: {"ä¸åŠ æ–™":0} },
    "Mr.Wish": { link: "https://www.mr-wish.com/load_page/get_menu_page", menu: {"æ°´æœèŒ¶": 60}, toppings: {"ä¸åŠ æ–™":0} },
    "Coco": { link: "https://coco-tea.nidin.shop/menu/21237", menu: {"å¥¶èŒ¶ä¸‰å…„å¼Ÿ": 55}, toppings: {"ä¸åŠ æ–™":0} },
    "Comebuy": { link: "https://drive.google.com/file/d/1Rq51uQuxEv4VDxwoB-hDczLhqECx9Gu2/view", menu: {"æµ·ç¥": 40}, toppings: {"ä¸åŠ æ–™":0} },
    "é¶´èŒ¶æ¨“": { link: "https://order.nidin.shop/menu/19710", menu: {"é¶´é ‚ç´…èŒ¶": 35}, toppings: {"ä¸åŠ æ–™":0} },
    "æ°´é›²å ‚": { link: "https://www.drinkstore.com.tw/web/product/product.jsp", menu: {"é»‘ç³–çç é®®å¥¶": 65}, toppings: {"ä¸åŠ æ–™":0} },
    "äº”æ¡è™Ÿ": { link: "https://www.wootea.com/menu/", menu: {"äº”æ¡èŒ¶": 35}, toppings: {"ä¸åŠ æ–™":0} },
    "æœ‰é£²": { link: "https://www.youindrink.com/pages/menu", menu: {"æ—ºæ—ºä¾†æ°´æœèŒ¶": 65}, toppings: {"ä¸åŠ æ–™":0} }
};

const iceLevels = ["æ­£å¸¸å†°", "å°‘å†°", "å¾®å†°", "å»å†°", "å¸¸æº«", "ç†±"];
const sugarLevels = ["æ­£å¸¸ç”œ", "åŠç³–", "å¾®ç³–", "äºŒåˆ†ç³–", "ç„¡ç³–"];

let currentStore = "";
let orders = [];

function init() {
    const selector = document.getElementById('storeSelector');
    Object.keys(stores).forEach(name => {
        const btn = document.createElement('button');
        btn.className = 'store-btn';
        btn.innerText = name;
        btn.onclick = () => selectStore(name, btn);
        selector.appendChild(btn);
    });
}

function selectStore(name, btn) {
    currentStore = name;
    document.querySelectorAll('.store-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('activeStoreName').innerText = name;
    document.getElementById('extMenu').href = stores[name].link;
    render();
}

function addPerson() {
    const name = prompt("è¼¸å…¥è¨‚é¤äººå§“åï¼š");
    if (!name) return;
    orders.push({ name, items: [{ drink: "", ice: "å»å†°", sugar: "ç„¡ç³–", topping: "ä¸åŠ æ–™", price: 0 }], paid: 0 });
    render();
}

function update(pIdx, iIdx, field, val) {
    const it = orders[pIdx].items[iIdx];
    it[field] = val;
    if (currentStore && (field === 'drink' || field === 'topping')) {
        const s = stores[currentStore];
        it.price = (s.menu[it.drink] || 0) + (s.toppings[it.topping] || 0);
    }
    render();
}

function render() {
    const container = document.getElementById('orderContainer');
    container.innerHTML = '';
    let totalP = 0, totalC = 0;
    const sData = stores[currentStore];

    orders.forEach((p, pIdx) => {
        let pSum = 0;
        const itemsHtml = p.items.map((it, iIdx) => {
            pSum += it.price; totalC++;
            let dOpts = `<option value="">-- è«‹é¸æ“‡å“é … --</option>`;
            if(sData) Object.keys(sData.menu).forEach(d => dOpts += `<option value="${d}" ${it.drink===d?'selected':''}>${d} ($${sData.menu[d]})</option>`);
            
            let tOpts = "";
            if(sData) Object.keys(sData.toppings).forEach(t => tOpts += `<option value="${t}" ${it.topping===t?'selected':''}>+ ${t} (+$${sData.toppings[t]})</option>`);

            return `
                <div style="background:white; border:1px solid #cbd5e1; padding:10px; border-radius:6px; margin-bottom:10px;">
                    <select class="drink-select" onchange="update(${pIdx},${iIdx},'drink',this.value)">${dOpts}</select>
                    <div class="spec-label">å†°åº¦</div>
                    <div class="spec-grid">${iceLevels.map(l => `<div class="spec-item ${it.ice===l?'selected':''}" onclick="update(${pIdx},${iIdx},'ice','${l}')">${l}</div>`).join('')}</div>
                    <div class="spec-label">ç”œåº¦</div>
                    <div class="spec-grid">${sugarLevels.map(l => `<div class="spec-item ${it.sugar===l?'selected':''}" onclick="update(${pIdx},${iIdx},'sugar','${l}')">${l}</div>`).join('')}</div>
                    <div class="spec-label">åŠ æ–™</div>
                    <select class="drink-select" onchange="update(${pIdx},${iIdx},'topping',this.value)">${tOpts}</select>
                    <div style="text-align:right; font-weight:bold; color:#2563eb;">å°è¨ˆ: $${it.price}</div>
                </div>`;
        }).join('');

        totalP += pSum;
        container.innerHTML += `
            <div class="person-card">
                <div class="person-header"><strong>ğŸ‘¤ ${p.name}</strong> <span style="color:blue;">æ‡‰ä»˜: $${pSum}</span></div>
                ${itemsHtml}
                <button onclick="orders[${pIdx}].items.push({drink:'',ice:'å»å†°',sugar:'ç„¡ç³–',topping:'ä¸åŠ æ–™',price:0});render()" style="color:blue; background:none; border:none; cursor:pointer;">+ å¹«ä»–åŠ é»å“é …</button>
                <div style="margin-top:10px; border-top:1px solid #ddd; padding-top:10px;">
                    æ”¶: <input type="number" style="width:50px" value="${p.paid}" oninput="orders[${pIdx}].paid=this.value;render()"> æ‰¾: ${p.paid-pSum > 0 ? p.paid-pSum : 0}
                </div>
            </div>`;
    });
    document.getElementById('totalPrice').innerText = totalP;
    document.getElementById('totalCount').innerText = totalC;
}

function copyResult() {
    let text = `ğŸ“‹ ã€é›»æ©Ÿç§‘æ™ºæ…§é»é¤ã€‘\nğŸ“ åº—å®¶ï¼š${currentStore}\n`;
    orders.forEach(p => {
        let s = 0; text += `ğŸ‘¤ ${p.name}ï¼š\n`;
        p.items.forEach(i => { text += `  - ${i.drink} (${i.sugar}/${i.ice}) ${i.topping!=='ä¸åŠ æ–™'?'+'+i.topping:''} $${i.price}\n`; s+=i.price; });
        text += `  ğŸ’° å€‹äººç¸½è¨ˆï¼š$${s}\n`;
    });
    text += `\nğŸ”¥ å…¨ç­ç¸½é‡‘é¡ï¼š$${document.getElementById('totalPrice').innerText}`;
    navigator.clipboard.writeText(text); alert("çµ±è¨ˆæ ¼å¼å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼");
}

window.onload = init;
</script>
</body>
</html>
