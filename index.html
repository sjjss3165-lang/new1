<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»æ©Ÿç§‘æ™ºæ…§é»é¤ç³»çµ± Pro</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background: #f1f5f9; color: #1e293b; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        h1 { color: #2563eb; text-align: center; border-bottom: 2px solid #e2e8f0; padding-bottom: 15px; }
        
        /* å•†åº—å¡ç‰‡å€ */
        .store-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .store-card { border: 1px solid #e2e8f0; padding: 15px; border-radius: 8px; transition: 0.2s; }
        .store-card:hover { border-color: #2563eb; background: #f8fafc; }
        .store-card h3 { margin: 0 0 10px 0; color: #1e3a8a; font-size: 1.1rem; }
        .btn-menu { display: inline-block; width: 100%; padding: 8px; background: #2563eb; color: white; text-align: center; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 10px; }

        /* é»é¤è¡¨å–® */
        .order-panel { border-top: 3px solid #2563eb; padding-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border-bottom: 1px solid #e2e8f0; text-align: left; }
        th { background: #f8fafc; color: #64748b; font-size: 0.85rem; }
        .item-row { display: flex; gap: 8px; align-items: center; margin-bottom: 8px; background: #f9fafb; padding: 8px; border-radius: 6px; }
        select, input { border: 1px solid #cbd5e1; padding: 6px; border-radius: 4px; outline: none; }
        .total-area { margin-top: 30px; background: #1e3a8a; color: white; padding: 20px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
        .btn-copy { width: 100%; padding: 15px; background: #1e293b; color: white; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1>é›»æ©Ÿç§‘æ™ºæ…§é»é¤ç³»çµ± ğŸ‘©ğŸ¼â€ğŸ³</h1>
    
    <div class="store-grid" id="storeGrid"></div>

    <div class="order-panel">
        <h2 id="currentStoreTitle">è«‹é»æ“Šä¸Šæ–¹ã€Œèœå–®é»é¤ã€é–‹å§‹</h2>
        <table id="orderTable">
            <thead>
                <tr>
                    <th width="15%">è¨‚è³¼äºº</th>
                    <th width="55%">å“é …æ˜ç´° (ä¾åº—å®¶è‡ªå‹•æ›´æ–°é¸å–®)</th>
                    <th width="15%">å€‹äººç´¯åŠ </th>
                    <th width="15%">æ”¶/æ‰¾éŒ¢</th>
                </tr>
            </thead>
            <tbody id="orderBody"></tbody>
        </table>
        <button onclick="addNewPerson()" style="margin-top:20px; padding:10px 20px; background:#10b981; color:white; border:none; border-radius:6px; cursor:pointer;">â• æ–°å¢è¨‚é¤åŒå­¸</button>
    </div>

    <div class="total-area">
        <div>ç¸½æ¯æ•¸ï¼š<span id="totalCount">0</span> æ¯</div>
        <div style="font-size: 1.5rem; font-weight: bold;">ç¸½é‡‘é¡ï¼š$<span id="finalTotal">0</span></div>
    </div>
    <button class="btn-copy" onclick="copyLine()">ğŸ“‹ è¤‡è£½ LINE çµ±è¨ˆæ ¼å¼</button>
</div>

<script>
// --- å®Œæ•´ 22 å®¶åº—ç²¾æº–èœå–®èˆ‡å°ˆå±¬åŠ æ–™ ---
const storeConfig = {
    "å¾—æ­£ #åŸºéš†æµ·å¤§": { link: "https://order.nidin.shop/menu/18739", menu: {"æ˜¥èŒ¶":35, "ç„™çƒé¾":35, "æª¸æª¬æ˜¥èŒ¶":50, "èŠå£«å¥¶è“‹æ˜¥èŒ¶":65}, toppings: {"ä¸åŠ æ–™":0, "èŒ¶å‡":10, "çç ":10} },
    "50åµ åŸºéš†æ·±æºªåº—": { link: "https://order.nidin.shop/menu/21216", menu: {"å››å­£æ˜¥":30, "çå¥¶":50, "ç´…èŒ¶æ‹¿éµ":60, "å†°æ·‡æ·‹ç´…èŒ¶":50}, toppings: {"ä¸åŠ æ–™":0, "æ³¢éœ¸":0, "çç ":0, "å¸ƒä¸":20} },
    "æ‹¾æ±£èŒ¶å±‹": { link: "https://www.19teahouse.com/", menu: {"æ„›ç‰å…¬çˆµ":45, "çç é®®å¥¶èŒ¶":60, "ç´”èŒ¶":30, "ç²‰ç²¿æ¡‚èŠ±":45}, toppings: {"ä¸åŠ æ–™":0, "ç²‰ç²¿":10, "çç ":10} },
    "å¯ä¸å¯": { link: "https://kebuke.com/menu/", menu: {"ç†Ÿæˆç´…èŒ¶":35, "ç†Ÿæˆå¥¶èŒ¶":50, "èƒ­è„‚ç´…èŒ¶":40}, toppings: {"ä¸åŠ æ–™":0, "ç™½ç‰çç ":10} },
    "è’Ÿè’»å±‹": { link: "https://drive.google.com/file/d/1T08WgpxufhYVOJ8sbfc7gvpthvoDaacY/view", menu: {"ç¶ è±†æ¹¯":55, "è±†èŠ±":45, "ç¶œåˆè’Ÿè’»":70}, toppings: {"åŸå‘³":0, "åŠ çç ":5, "åŠ ç´…è±†":10} },
    "å¤§ç¢—ç‰›è‚‰éºµ": { link: "https://drive.google.com/file/d/12wii4UGfDTHYECO5ObXyS6qutY9qRcaX/view", menu: {"ç‰›è‚‰éºµ":150, "ç‚¸é†¬éºµ":70, "åŠç­‹åŠè‚‰":180}, toppings: {"æ­£å¸¸":0, "åŠ å¤§":20} },
    "æ¸…å¿ƒ": { link: "http://chingshin.tw/", menu: {"çƒé¾ç¶ ":30, "éš±è—ç‰ˆ":50}, toppings: {"ä¸åŠ æ–™":0, "çç ":10, "æ¤°æœ":10} },
    "é¾œè¨˜": { link: "https://guiji.doteat.tw/menu", menu: {"ç´…æŸšç¿¡ç¿ ":75, "è˜‹æœç´…è±":55}, toppings: {"ä¸åŠ æ–™":0, "çç ":10} },
    "è¿·å®¢å¤": { link: "https://milksha.nidin.shop/menu/491", menu: {"çç é®®å¥¶":70, "ç„™èŒ¶æ‹¿éµ":65}, toppings: {"ä¸åŠ æ–™":0, "çç ":10} },
    "äº”æ¡è™Ÿ": { link: "https://www.wootea.com/menu/", menu: {"äº”æ¡èŒ¶":35, "è€å¯¦äººç´…èŒ¶":35}, toppings: {"ä¸åŠ æ–™":0, "å°çç ":10} },
    "æœ‰é£²": { link: "https://www.youindrink.com/pages/menu", menu: {"æ—ºæ—ºä¾†æ°´æœèŒ¶":65, "ç²‰ç²¿ç´…":40}, toppings: {"ä¸åŠ æ–™":0, "ç²‰ç²¿":10} },
    "æ—é¦™æª¸": { link: "https://www.lamheunglingoverseas.com/cz", menu: {"æ‹›ç‰Œæª¸æª¬èŒ¶":55, "ç¶ å¦æª¸æª¬èŒ¶":55}, toppings: {"ä¸åŠ æ–™":0} },
    "Mr.Wish": { link: "https://www.mr-wish.com/load_page/get_menu_page", menu: {"æ°´æœèŒ¶":60, "å…‰æœèŒ¶":60}, toppings: {"ä¸åŠ æ–™":0} },
    "Coco": { link: "https://coco-tea.nidin.shop/menu/21237", menu: {"å¥¶èŒ¶ä¸‰å…„å¼Ÿ":55, "çç å¥¶èŒ¶":45}, toppings: {"ä¸åŠ æ–™":0} },
    "Comebuy": { link: "https://drive.google.com/file/d/1Rq51uQuxEv4VDxwoB-hDczLhqECx9Gu2/view", menu: {"æµ·ç¥":40, "è˜‹æœå†°èŒ¶":50}, toppings: {"ä¸åŠ æ–™":0, "ç²‰æ¢":10} },
    "é¶´èŒ¶æ¨“": { link: "https://order.nidin.shop/menu/19710", menu: {"é¶´é ‚ç´…èŒ¶":35, "ç¶ºå¤¢é‚£å ¤":60}, toppings: {"ä¸åŠ æ–™":0, "èŒ¶å‡":10} },
    "æ°´é›²å ‚": { link: "https://www.drinkstore.com.tw/web/product/product.jsp", menu: {"é»‘ç³–çç é®®å¥¶":65}, toppings: {"ä¸åŠ æ–™":0} },
    "éº¥å…‹éºµç·š": { link: "http://google.com/maps", menu: {"å¤§è…¸éºµç·š":55}, toppings: {"ä¸åŠ æ–™":0} },
    "è±†ä¹¾åŒ…": { link: "https://drive.google.com/file/d/18VeBd_w6HFvBD321t7Iu-QaNfko5CljQ/view", menu: {"è±†ä¹¾åŒ…":50}, toppings: {"ä¸åŠ æ–™":0} },
    "ç¾é¦™é½‹": { link: "https://drive.google.com/file/d/1pjCLx6xivI5e_Ud1zmMglOFFZtsjDFij/view", menu: {"æ»·å‘³":100}, toppings: {"ä¸åŠ æ–™":0} },
    "é‚±è¨˜ç‚’éºµ": { link: "https://drive.google.com/file/d/1zuEI_w-zwS9rIGRcekHsb_QXll1twyg3/view", menu: {"ç‚’éºµ":80}, toppings: {"ä¸åŠ æ–™":0} },
    "å»–åª½åª½": { link: "https://drive.google.com/file/d/1j_SjavYZbnJjJHCJNSzVQaAzf_1e5Km0/view", menu: {"æ’éª¨é£¯":90}, toppings: {"ä¸åŠ æ–™":0, "åŠ è›‹":15} }
};

let orders = JSON.parse(localStorage.getItem('ee_orders')) || [];
let activeStore = "";

function init() {
    const grid = document.getElementById('storeGrid');
    Object.keys(storeConfig).forEach(name => {
        grid.innerHTML += `<div class="store-card"><h3>${name}</h3><a href="#" class="btn-menu" onclick="selectStore('${name}')">èœå–®é»é¤</a></div>`;
    });
    render();
}

function selectStore(name) {
    activeStore = name;
    document.getElementById('currentStoreTitle').innerText = `ğŸ“ æ­£åœ¨è¨‚è³¼ï¼š${name}`;
    window.open(storeConfig[name].link, '_blank');
    render();
}

function addNewPerson() {
    const name = prompt("è¼¸å…¥å§“åï¼š");
    if (!name) return;
    orders.push({ name, items: [{ drink: "", sugar: "æ­£å¸¸", ice: "æ­£å¸¸", topping: "ä¸åŠ æ–™", price: 0 }], paid: 0 });
    save();
}

function addItem(pIdx) {
    orders[pIdx].items.push({ drink: "", sugar: "æ­£å¸¸", ice: "æ­£å¸¸", topping: "ä¸åŠ æ–™", price: 0 });
    save();
}

function update(pIdx, iIdx, field, val) {
    const item = orders[pIdx].items[iIdx];
    item[field] = val;
    if (activeStore && (field === 'drink' || field === 'topping')) {
        const s = storeConfig[activeStore];
        item.price = (s.menu[item.drink] || 0) + (s.toppings[item.topping] || 0);
    }
    save();
}

function save() {
    localStorage.setItem('ee_orders', JSON.stringify(orders));
    render();
}

function render() {
    const body = document.getElementById('orderBody');
    body.innerHTML = '';
    let gTotal = 0, gCount = 0;
    const s = storeConfig[activeStore];

    orders.forEach((p, pIdx) => {
        let pSum = 0;
        const itemsHtml = p.items.map((it, iIdx) => {
            pSum += it.price; gCount++;
            let dOpts = `<option value="">é¸å“é …...</option>`;
            if(s) Object.keys(s.menu).forEach(d => dOpts += `<option value="${d}" ${it.drink===d?'selected':''}>${d}($${s.menu[d]})</option>`);
            let tOpts = "";
            if(s) Object.keys(s.toppings).forEach(t => tOpts += `<option value="${t}" ${it.topping===t?'selected':''}>+${t}($${s.toppings[t]})</option>`);

            return `<div class="item-row">
                <select onchange="update(${pIdx},${iIdx},'drink',this.value)">${dOpts}</select>
                <select onchange="update(${pIdx},${iIdx},'sugar',this.value)">${["æ­£å¸¸","åŠç³–","ç„¡ç³–"].map(x=>`<option ${it.sugar===x?'selected':''}>${x}</option>`).join('')}</select>
                <select onchange="update(${pIdx},${iIdx},'ice',this.value)">${["æ­£å¸¸","å°‘å†°","å»å†°"].map(x=>`<option ${it.ice===x?'selected':''}>${x}</option>`).join('')}</select>
                <select onchange="update(${pIdx},${iIdx},'topping',this.value)">${tOpts}</select>
                <strong>$${it.price}</strong>
            </div>`;
        }).join('');

        gTotal += pSum;
        body.innerHTML += `<tr>
            <td><strong>${p.name}</strong></td>
            <td>${itemsHtml} <button onclick="addItem(${pIdx})" style="color:blue;border:none;background:none;cursor:pointer;">+ åŠ é»</button></td>
            <td><span style="font-weight:bold;color:blue;">$${pSum}</span></td>
            <td>æ”¶:<input type="number" style="width:45px" value="${p.paid}" oninput="orders[${pIdx}].paid=this.value;save()">æ‰¾:${p.paid-pSum>0?p.paid-pSum:0}</td>
        </tr>`;
    });
    document.getElementById('finalTotal').innerText = gTotal;
    document.getElementById('totalCount').innerText = gCount;
}

function copyLine() {
    let t = `ğŸ“‹ ã€é›»æ©Ÿç§‘é»é¤ã€‘\nğŸ“ åº—å®¶ï¼š${activeStore}\n`;
    orders.forEach(p => {
        let s = 0; t += `ğŸ‘¤ ${p.name}ï¼š\n`;
        p.items.forEach(i => { t += `  - ${i.drink}(${i.sugar}/${i.ice})${i.topping!=='ä¸åŠ æ–™'?'+'+i.topping:''} $${i.price}\n`; s+=i.price; });
        t += `  ğŸ’° å°è¨ˆï¼š$${s}\n`;
    });
    t += `\nğŸ”¥ ç¸½è¨ˆï¼š$${document.getElementById('finalTotal').innerText}`;
    navigator.clipboard.writeText(t); alert("å·²è¤‡è£½ï¼");
}

window.onload = init;
</script>
</body>
</html>
